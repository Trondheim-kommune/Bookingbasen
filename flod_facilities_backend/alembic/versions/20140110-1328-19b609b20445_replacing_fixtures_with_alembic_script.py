# -*- coding: utf-8 -*-
"""replacing fixtures with alembic script

Revision ID: 19b609b20445
Revises: 33134fcc7129
Create Date: 2014-01-10 13:28:14.041224

"""

# revision identifiers, used by Alembic.
from logging import getLogger

from geoalchemy2 import Geometry, WKTElement
from shapely.geometry import shape
from sqlalchemy.sql import table, column
from sqlalchemy import (String)

revision = '19b609b20445'
down_revision = '33134fcc7129'

from alembic import op

logger = getLogger('logger for %s' % revision)


def json_to_wkt(json):
    dict_as_shape = shape(json)
    wkt_element = WKTElement(dict_as_shape.wkt, srid=4326)
    return wkt_element.desc


def upgrade():
    facility_types_table = table('facility_types',
                                 column('name', String)
    )
    op.bulk_insert(
        facility_types_table,
        [
            {"name": "Auditorium"},
            {"name": "Barnehagerom"},
            {"name": "Bibliotek"},
            {"name": "Dansesal"},
            {"name": "Festsal/forsamlingslokale"},
            {"name": "Formingsrom/sløydsal/verksted"},
            {"name": "Gymsal/treningsrom"},
            {"name": "Idrettshall"},
            {"name": "Isidrettshall (ishall/skøytebane)"},
            {"name": "Kafe/kantine/kjøkken"},
            {"name": "Musikkrom"},
            {"name": "Møterom"},
            {"name": "Svømmebasseng"},
            {"name": "Utendørs skianlegg"},
            {"name": "Utendørs friidrettsanlegg"},
            {"name": "Annet"}
        ]
    )
    unit_types_table = table('facility_unit_types',
                             column('name', String)
    )
    op.bulk_insert(
        unit_types_table,
        [
            {"name": "Barnehage"},
            {"name": "Skole"},
            {"name": "Helse og velferdssenter"},
            {"name": "Helsehus"},
            {"name": "Bibliotek"},
            {"name": "Kulturenheten"},
            {"name": "Idrettsanlegg"}
        ]
    )
    district_table = table('districts',
                           column('name', String),
                           column('geog', Geometry(geometry_type='POLYGON', srid=4326))
    )

    trondheim_sentrum = {"type": "POLYGON", "srid": 4326, "coordinates": [
        [[10.374269485473633, 63.434391886868802, 0.0], [10.375986099243164, 63.431896727411036, 0.0],
         [10.372982025146484, 63.428095990068861, 0.0], [10.372123718261719, 63.426944151946422, 0.0],
         [10.384140014648438, 63.419648101985686, 0.0], [10.385684967041016, 63.415384813301102, 0.0],
         [10.394182205200195, 63.413348965346238, 0.0], [10.395212173461914, 63.41254226862555, 0.0],
         [10.402250289916992, 63.412657512403641, 0.0], [10.404396057128906, 63.413041654985712, 0.0],
         [10.407829284667969, 63.412926412751411, 0.0], [10.408773422241211, 63.412887998570397, 0.0],
         [10.41203498840332, 63.413502619291478, 0.0], [10.411262512207031, 63.415192758348248, 0.0],
         [10.411520004272461, 63.416498706659553, 0.0], [10.413236618041992, 63.418649550681671, 0.0],
         [10.411434173583984, 63.419955341543357, 0.0], [10.412206649780273, 63.421376281665211, 0.0],
         [10.412721633911133, 63.422451540884616, 0.0], [10.415210723876953, 63.423392359614375, 0.0],
         [10.416927337646484, 63.424909124783511, 0.0], [10.416626930236816, 63.426656185181798, 0.0],
         [10.416069030761719, 63.42913260479606, 0.0], [10.422120094299316, 63.431392870765983, 0.0],
         [10.424995422363281, 63.432561324767299, 0.0], [10.427999496459961, 63.433624168641991, 0.0],
         [10.426325798034668, 63.434247941268339, 0.0], [10.425518453121185, 63.434238344869257, 0.0],
         [10.424453616142273, 63.434041617979737, 0.0], [10.423321723937988, 63.434372694163827, 0.0],
         [10.422098636627197, 63.434448265365205, 0.0], [10.421798229217529, 63.434787733540809, 0.0],
         [10.421395897865295, 63.434962863959512, 0.0], [10.42253851890564, 63.435488248792112, 0.0],
         [10.423836708068848, 63.435927261605045, 0.0], [10.423954725265503, 63.435975240739651, 0.0],
         [10.423968136310577, 63.436055605610051, 0.0], [10.423906445503235, 63.436135970254981, 0.0],
         [10.423812568187714, 63.436251119204016, 0.0], [10.423729419708252, 63.436301496723665, 0.0],
         [10.417313575744629, 63.43588887823951, 0.0], [10.418515205383301, 63.436503005916379, 0.0],
         [10.419641733169556, 63.437037957967966, 0.0], [10.42402982711792, 63.439621419846375, 0.0],
         [10.424791574478149, 63.440393774530634, 0.0], [10.425724983215332, 63.441185296541256, 0.0],
         [10.426025390625, 63.441463523324678, 0.0], [10.426626205444336, 63.441703371830698, 0.0],
         [10.426626205444336, 63.441703371830698, 0.0], [10.426840782165527, 63.441952812146148, 0.0],
         [10.425574779510498, 63.44232696854575, 0.0], [10.423793792724609, 63.442547622592606, 0.0],
         [10.415425300598145, 63.447708523589746, 0.0], [10.381736755371094, 63.457202918490786, 0.0],
         [10.374269485473633, 63.434391886868802, 0.0]]]}
    trondheim_vest = {"type": "Polygon", "srid": 4326, "coordinates": [
        [[10.20355224609375, 63.345122236072093, 0.0], [10.238742828369141, 63.38313998421129, 0.0],
         [10.252647399902344, 63.385985443096992, 0.0], [10.2886962890625, 63.383985960904859, 0.0],
         [10.29818058013916, 63.383043848918923, 0.0], [10.316934585571289, 63.382620849808596, 0.0],
         [10.324230194091797, 63.38281312290399, 0.0], [10.334916114807129, 63.382217072117363, 0.0],
         [10.347447395324707, 63.383793695663243, 0.0], [10.354399681091309, 63.383486068598678, 0.0],
         [10.357017517089844, 63.384793460860436, 0.0], [10.358948707580566, 63.384389713721511, 0.0],
         [10.359978675842285, 63.384793460860436, 0.0], [10.362081527709961, 63.384505070626282, 0.0],
         [10.36259651184082, 63.383255346137268, 0.0], [10.365815162658691, 63.383505295386783, 0.0],
         [10.376029014587402, 63.383486068598678, 0.0], [10.379548072814941, 63.387734875789057, 0.0],
         [10.387744903564453, 63.39375134135522, 0.0], [10.385856628417969, 63.394520127866706, 0.0],
         [10.387229919433594, 63.396672620539853, 0.0], [10.39031982421875, 63.400977121550696, 0.0],
         [10.389633178710938, 63.404973580018897, 0.0], [10.39057731628418, 63.408085820676114, 0.0],
         [10.387659072875977, 63.410006788328538, 0.0], [10.389461517333984, 63.411274556498419, 0.0],
         [10.394697189331055, 63.411543469814482, 0.0], [10.395212173461914, 63.41254226862555, 0.0],
         [10.394182205200195, 63.413348965346209, 0.0], [10.385684967041016, 63.415384813301081, 0.0],
         [10.384140014648438, 63.419648101985715, 0.0], [10.372123718261719, 63.426944151946365, 0.0],
         [10.375986099243164, 63.431896727411036, 0.0], [10.351953506469727, 63.45116139517863, 0.0],
         [10.298995971679688, 63.462169438012424, 0.0], [10.161666870117188, 63.455726219435107, 0.0],
         [10.05523681640625, 63.406587376586799, 0.0], [10.04425048828125, 63.370908991254169, 0.0],
         [10.108108520507812, 63.34843347201425, 0.0], [10.165786743164062, 63.336418798456691, 0.0],
         [10.20355224609375, 63.345122236072093, 0.0]]]}
    trondheim_oest = {"type": "Polygon", "srid": 4326, "coordinates": [
        [[10.387744903564453, 63.39374173139349, 0.0], [10.391178131103516, 63.393280449446848, 0.0],
         [10.391693115234375, 63.392050328008864, 0.0], [10.389976501464844, 63.39043571360822, 0.0],
         [10.386199951171875, 63.389743708203198, 0.0], [10.383110046386719, 63.388821008378109, 0.0],
         [10.382595062255859, 63.387821383430683, 0.0], [10.386371612548828, 63.386744825326922, 0.0],
         [10.384654998779297, 63.384514683680749, 0.0], [10.385856628417969, 63.384130158991162, 0.0],
         [10.388259887695312, 63.384053253435269, 0.0], [10.392379760742188, 63.384591588000681, 0.0],
         [10.395126342773438, 63.382822736524957, 0.0], [10.398044586181641, 63.379669296223469, 0.0],
         [10.394096374511719, 63.376977060984778, 0.0], [10.395641326904297, 63.375823168620464, 0.0],
         [10.398044586181641, 63.375823168620464, 0.0], [10.402336120605469, 63.377900141498465, 0.0],
         [10.405597686767578, 63.376515509602022, 0.0], [10.406627655029297, 63.373746045538624, 0.0],
         [10.410919189453125, 63.372668959619091, 0.0], [10.413665771484375, 63.372822831508813, 0.0],
         [10.416584014892578, 63.371361015277543, 0.0], [10.416755676269531, 63.366667312985868, 0.0],
         [10.418987274169922, 63.365128227273402, 0.0], [10.42327880859375, 63.364127777352358, 0.0],
         [10.426025390625, 63.358894087058403, 0.0], [10.432720184326172, 63.349732835440861, 0.0],
         [10.438385009765625, 63.347807831645795, 0.0], [10.438728332519531, 63.343110281533221, 0.0],
         [10.437698364257812, 63.339798432654561, 0.0], [10.442676544189453, 63.338951154249322, 0.0],
         [10.639057159423828, 63.32300226119559, 0.0], [10.679397583007812, 63.339490334303569, 0.0],
         [10.632705688476562, 63.367205973509591, 0.0], [10.63201904296875, 63.394587395706644, 0.0],
         [10.610733032226562, 63.39089704127651, 0.0], [10.590476989746094, 63.422557144525506, 0.0],
         [10.593223571777344, 63.42893104375819, 0.0], [10.5898118019104, 63.433643361848397, 0.0],
         [10.589210987091064, 63.433921661896285, 0.0], [10.588910579681396, 63.43443986857487, 0.0],
         [10.573632717132568, 63.438057457757971, 0.0], [10.44525146484375, 63.461239479676763, 0.0],
         [10.415425300598145, 63.447698931699783, 0.0], [10.423793792724609, 63.442538028973743, 0.0],
         [10.426969528198242, 63.442058343933269, 0.0], [10.425724983215332, 63.441175702466019, 0.0],
         [10.424716472625732, 63.440168306682239, 0.0], [10.423568487167358, 63.43935756720002, 0.0],
         [10.421878695487976, 63.438338113683649, 0.0], [10.420390069484711, 63.437502134724674, 0.0],
         [10.420017912983894, 63.437211575348591, 0.0], [10.419463366270065, 63.436959395007747, 0.0],
         [10.418515205383301, 63.436493410272696, 0.0], [10.417313575744629, 63.43587928239009, 0.0],
         [10.417892932891846, 63.43589367616304, 0.0], [10.42128324508667, 63.436150363898854, 0.0],
         [10.423729419708252, 63.436291901012453, 0.0], [10.423812568187714, 63.436251119204016, 0.0],
         [10.423913151025772, 63.436110781360668, 0.0], [10.423954725265503, 63.436013623989446, 0.0],
         [10.423836708068848, 63.43591766576855, 0.0], [10.42253851890564, 63.43548824879214, 0.0],
         [10.421648025512695, 63.435051628283482, 0.0], [10.421395897865295, 63.434962863959512, 0.0],
         [10.421798229217529, 63.434787733540809, 0.0], [10.422098636627197, 63.434448265365234, 0.0],
         [10.423321723937988, 63.434363097806582, 0.0], [10.424453616142273, 63.434065609136184, 0.0],
         [10.42553186416626, 63.434255138565526, 0.0], [10.426325798034668, 63.434238344869236, 0.0],
         [10.427227020263672, 63.433787310486522, 0.0], [10.427999496459961, 63.433614572033967, 0.0],
         [10.42528510093689, 63.43264529806553, 0.0], [10.416069030761719, 63.429123006683533, 0.0],
         [10.417013168334961, 63.425053117304941, 0.0], [10.415210723876953, 63.423382759579141, 0.0],
         [10.412721633911133, 63.422441940534327, 0.0], [10.411434173583984, 63.419945740357086, 0.0],
         [10.413236618041992, 63.418639949057962, 0.0], [10.411520004272461, 63.41648910431546, 0.0],
         [10.411262512207031, 63.415183155566844, 0.0], [10.41203498840332, 63.413493015943963, 0.0],
         [10.408773422241211, 63.412878395017081, 0.0], [10.406970977783203, 63.412897602120481, 0.0],
         [10.404396057128906, 63.413032051483867, 0.0], [10.402250289916992, 63.412647908773152, 0.0],
         [10.395212173461914, 63.412532664956494, 0.0], [10.394697189331055, 63.411533865810931, 0.0],
         [10.389032363891602, 63.410707909470368, 0.0], [10.387659072875977, 63.409997183810326, 0.0],
         [10.390920639038086, 63.407807269685648, 0.0], [10.389633178710938, 63.404963973815136, 0.0],
         [10.39031982421875, 63.401198094130933, 0.0], [10.385856628417969, 63.394510518162427, 0.0],
         [10.387744903564453, 63.39374173139349, 0.0]]]}
    trondheim_soer = {"type": "Polygon", "srid": 4326, "coordinates": [
        [[10.20355224609375, 63.345122236072093, 0.0], [10.225181579589844, 63.342811845668088, 0.0],
         [10.249385833740234, 63.338652675230882, 0.0], [10.261402130126953, 63.337882392488311, 0.0],
         [10.260543823242188, 63.334338826223131, 0.0], [10.253677368164062, 63.330948919655334, 0.0],
         [10.251789093017578, 63.328329172870816, 0.0], [10.254707336425781, 63.326094494515928, 0.0],
         [10.26397705078125, 63.323628441181434, 0.0], [10.273933410644531, 63.3232431012636, 0.0],
         [10.3106689453125, 63.317847800792592, 0.0], [10.325946807861328, 63.317616551035037, 0.0],
         [10.351009368896484, 63.322009978863981, 0.0], [10.364227294921875, 63.318233212928149, 0.0],
         [10.39581298828125, 63.314610135179571, 0.0], [10.404739379882812, 63.319543575601983, 0.0],
         [10.41778564453125, 63.324399105543137, 0.0], [10.424652099609375, 63.324322040035391, 0.0],
         [10.432891845703125, 63.330255480478556, 0.0], [10.435123443603516, 63.334801055269345, 0.0],
         [10.444221496582031, 63.337266151444638, 0.0], [10.442676544189453, 63.33896078255318, 0.0],
         [10.437183380126953, 63.340424247271336, 0.0], [10.439586639404297, 63.343813037629594, 0.0],
         [10.43701171875, 63.347663451166184, 0.0], [10.435466766357422, 63.349357469815182, 0.0],
         [10.430660247802734, 63.352591228311631, 0.0], [10.42877197265625, 63.356671404539171, 0.0],
         [10.425853729248047, 63.358364892523838, 0.0], [10.424652099609375, 63.361597637998841, 0.0],
         [10.42327880859375, 63.364137397228987, 0.0], [10.416755676269531, 63.366676932012354, 0.0],
         [10.416584014892578, 63.371370632732649, 0.0], [10.41229248046875, 63.373217124464162, 0.0],
         [10.409374237060547, 63.372909384084572, 0.0], [10.406627655029297, 63.3744480530139, 0.0],
         [10.405082702636719, 63.377063601043226, 0.0], [10.402336120605469, 63.377909756764339, 0.0],
         [10.398044586181641, 63.375832784581704, 0.0], [10.395641326904297, 63.375832784581704, 0.0],
         [10.394096374511719, 63.376986676559667, 0.0], [10.398044586181641, 63.37967891089702, 0.0],
         [10.396499633789062, 63.380986476513179, 0.0], [10.395298004150391, 63.38190942816054, 0.0],
         [10.395126342773438, 63.382832350142714, 0.0], [10.392379760742188, 63.384601201026193, 0.0],
         [10.388259887695312, 63.384062866641003, 0.0], [10.385856628417969, 63.384139772171174, 0.0],
         [10.384654998779297, 63.38498571940724, 0.0], [10.386371612548828, 63.386754437631438, 0.0],
         [10.384483337402344, 63.387215824464946, 0.0], [10.382595062255859, 63.387830995374756, 0.0],
         [10.384140014648438, 63.38944575629376, 0.0], [10.389976501464844, 63.390445324676904, 0.0],
         [10.391693115234375, 63.392059938536931, 0.0], [10.391178131103516, 63.393290059563014, 0.0],
         [10.387744903564453, 63.39375134135522, 0.0], [10.381393432617188, 63.389830209791185, 0.0],
         [10.376415252685547, 63.385216427963954, 0.0], [10.376029014587402, 63.383486068598678, 0.0],
         [10.365815162658691, 63.383505295386783, 0.0], [10.36259651184082, 63.383255346137268, 0.0],
         [10.362081527709961, 63.384505070626282, 0.0], [10.359978675842285, 63.384793460860436, 0.0],
         [10.357017517089844, 63.384793460860436, 0.0], [10.354399681091309, 63.383486068598678, 0.0],
         [10.347447395324707, 63.383793695663243, 0.0], [10.334916114807129, 63.382217072117363, 0.0],
         [10.324230194091797, 63.38281312290399, 0.0], [10.29818058013916, 63.383043848918923, 0.0],
         [10.253849029541016, 63.386369942939012, 0.0], [10.238742828369141, 63.38313998421129, 0.0],
         [10.20355224609375, 63.345122236072093, 0.0]]]}
    geog_trondheim_sentrum = json_to_wkt(trondheim_sentrum)
    geog_trondheim_vest = json_to_wkt(trondheim_vest)
    geog_trondheim_soer = json_to_wkt(trondheim_soer)
    geog_trondheim_oest = json_to_wkt(trondheim_oest)
    op.bulk_insert(
        district_table,
        [
            {"name": "Trondheim Sentrum", "geog": 'SRID=4326;' + geog_trondheim_sentrum},
            {"name": "Trondheim Vest", "geog": 'SRID=4326;' + geog_trondheim_vest},
            {"name": "Trondheim Øst", "geog": 'SRID=4326;' + geog_trondheim_oest},
            {"name": "Trondheim Sør", "geog": 'SRID=4326;' + geog_trondheim_soer}
        ]
    )


def downgrade():
    raise NotImplementedError('This application does not support downgrades.')
